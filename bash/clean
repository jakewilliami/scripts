#! /bin/bash
#Script for emptying * directories! 

BASH_DIR="/Users/jakeireland/bin/scripts/bash/"


#Clean up
clean-exit() {
    [[ -f ${BASH_DIR}/textcolours.txt ]] && \
    rm /Users/jakeireland/bin/scripts/bash/textcolours.txt
    exit $?
}


# Colours
jq -r 'to_entries|map("\(.key)=\(.value|tostring)")|.[]' ${BASH_DIR}/textcolours.json | sed -e 's/=\([^" >][^ >]*\)/="\1"/g' >> ${BASH_DIR}/textcolours.txt && source ${BASH_DIR}/textcolours.txt


# Help
HELP="${BWHITE}Invalid option.  Use option -h for help.${NORM}"
display_help() {
    echo -e "${BWHITE}Usage: [sudo] empt [option...]${NORM}"
    echo
    echo -e "${BWHITE}The present script will help to clear deprecated files.  ${ITBRED}Omitting option altogether will iteratively delete everything in both Trash and Downloads.${NORM}"
    echo
    echo -e "${BBLUE}\t -t \t${BYELLOW}Interatively ${BRED}deletes everything in ${BBLUE}t${BRED}rash ${BYELLOW}(shared and local).${NORM}"
    echo -e "${BBLUE}\t -d \t${BYELLOW}Interatively ${BRED}deletes everything in ${BBLUE}d${BRED}ownloads folder.${NORM}"
    echo -e "${BBLUE}\t -h \t${BYELLOW}Shows ${BBLUE}h${BYELLOW}elp (present output).${NORM}"
    clear-exit
}


# Options
while getopts ":tdh" OPTION; do
        case $OPTION in
                t)
                    rm -drf ~/Library/Mobile\ Documents/com\~apple\~CloudDocs/.Trash/*
                    rm -drf ~/.Trash*  
                    ;;

                d)
                    rm -drf ~/Downloads/*
                    ;;
                h)
                    display_help
                    ;;
                \?)
                    echo -e "${HELP}"
                    ;;
        esac
done


# If no options
[[ -z $1 ]] && \
rm -drf ~/Library/Mobile\ Documents/com\~apple\~CloudDocs/.Trash/* && \
rm -drf ~/.Trash* && rm -drf ~/Downloads/*


# Clean up
clean-exit
