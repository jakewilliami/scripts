#! /bin/bash
#Script for emptying * directories! 

BASH_DIR="/Users/jakeireland/bin/scripts/bash/"


#Clean up
clean-exit() {
    if [[ -f ${BASH_DIR}/textcolours.txt ]]
    then
        rm /Users/jakeireland/bin/scripts/bash/textcolours.txt
    fi
    exit $?
}


# Colours
jq -r 'to_entries|map("\(.key)=\(.value|tostring)")|.[]' ${BASH_DIR}/textcolours.json | sed -e 's/=\([^" >][^ >]*\)/="\1"/g' >> ${BASH_DIR}/textcolours.txt && source ${BASH_DIR}/textcolours.txt


# Help
HELP="${BWHITE}Invalid option.  Use option -h for help.${NORM}"
display_help() {
    echo -e "\033[1;38mUsage: [sudo] empt [option...]${NORM}"
    echo
    echo -e "${ITBRED}Omitting option altogether will iteratively delete everything in both Trash and Downloads.${NORM}"
    echo
    echo -e "${DARKBBLUE}   -t           ${BYELLOW}Interatively ${BRED}deletes everything in Trash ${BYELLOW}(shared and local).${NORM}"
    echo -e "${DARKBBLUE}   -d           ${BYELLOW}Interatively ${BRED}deletes everything in Downloads folder.${NORM}"
    echo -e "${DARKBBLUE}   -h           ${BYELLOW}Shows help (present output).${NORM}"
}


# Options
while getopts ":tdh" OPTION; do
        case $OPTION in
                t)
                    rm -drf ~/Library/Mobile\ Documents/com\~apple\~CloudDocs/.Trash/* && rm -drf ~/.Trash*  
                    ;;

                d)
                    rm -drf ~/Downloads/*
                    ;;
                h)
                    display_help
                    ;;
                \?)
                    echo -e "${HELP}"
                    ;;
        esac
done


# If no options
if [[ -z $1 ]]
then
    rm -drf ~/Library/Mobile\ Documents/com\~apple\~CloudDocs/.Trash/* && rm -drf ~/.Trash* && rm -drf ~/Downloads/*
fi


# Clean up
clean-exit
